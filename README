This is extracted version of code I have used in one of the current project.
